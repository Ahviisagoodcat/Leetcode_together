Ruyu do algorithm and SQL here
